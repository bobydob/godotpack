<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="Smash Karts" />
<Content type="html"><![CDATA[

<!DOCTYPE html>
<html lang="en-us">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">


      <!-- <script type="text/javascript" src="xmlhttprequest-length-computable.js"></script> -->
      <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/zhit73/xml@943946a87f66424f2f80ac97c4b4a89995eba7c1/xmlhttprequest-length-computable.min.js"></script>
      <script type="text/javascript">
        window.xmlHTTPRequestLengthComputable = {
          CONTENT_ENCODING_MULTIPLE: 3.0
        }
      </script>

      <title>Smash Karts</title>
	<link rel="stylesheet" href="css/main.css" />
	<meta name="viewport" content="minimal-ui, user-scalable=no, initial-scale=1, maximum-scale=1, width=device-width, viewport-fit=cover" />

	<script src="https://cdn.jsdelivr.net/gh/tallteam/skunblocked1@main/scripts/ads-init.js"></script>	
</head>

<body>
<div id="mainContainer">
	<div id="mainContainerBg"></div>
	<div id="leftContainer">
		<div id="gameContainer">
			<canvas id="gameCanvas"></canvas>

			<!-- On canvas ad containers -->
			<div id="adContainerMainMenu"> <!-- main menu -->
				<div id="smashkarts-io_300x250"></div> <!-- adinplay -->

				<!-- playwire -->
				<div id="pw_mainmenu"></div>
				<!-- dummy placement to ensure rewarded videos init correctly when ads are disabled for season pass holders -->
				<div id="pw_mainmenu_dummy" data-pw-desk="med_rect_atf" data-pw-mobi="med_rect_atf"></div> 
			</div>
			<div id="adContainerWin"> <!-- win ceremony -->
				<div id="smashkarts-io_300x250_2"></div> <!-- adinplay -->

				<!-- playwire -->
				<div id="pw_roundend"></div>
				<!-- <div data-pw-desk="med_rect_btf" data-pw-mobi="med_rect_btf"></div> -->
			</div>
			<div id="adContainerSpectate"> <!-- spectate -->
				<div id="smashkarts-io_300x250_3"></div> <!-- adinplay -->
			</div>
			<div id="adContainerDeath"> <!-- death -->

				<!-- adinplay -->
				<div id="smashkarts-io_728x90-new"></div>
				<div id="smashkarts-io_320x100"></div>

				<!-- playwire -->
				<div id="pw_ondeath"></div>
				<!-- <div data-pw-desk="leaderboard_atf" data-pw-mobi="leaderboard_atf"></div> -->
			</div>
		</div>
		<div id="btmContainer">
			<div id="btmAdPlaceholder">
				<div id="btmAdPlaceholderBg"></div>
				<div id="btmAdBlockerContainer">
					<img id="btmAdBlockerImg" src="images/turnoffadblock.png">
					<h1 id="btmAdBlockerText">Disable AdBlock for extra XP</h1>
				</div>
			</div>
			<h1 id="btmAdResText">unset</h1>
		</div>
		<div id="pw-video-container"> <!-- playwire -->
			<div id="pw-video-placeholder"></div>
		</div>
		<div id="preroll"></div> <!-- adinplay -->
		<iframe id="xsolla-iframe"></iframe>
	</div>
	<div id="rightContainer">
		<div id="rightAdPlaceholder">
			<div id="rightAdPlaceholderBg"></div>
			<div id="rightAdBlockerContainer">
				<img id="rightAdBlockerImg" src="images/turnoffadblock.png">
				<h1 id="rightAdBlockerText">Disable AdBlock for extra XP</h1>
			</div>
		</div>
		<h1 id="rightAdResText">unset</h1>
	</div>
</div>
<div id="loader">
	<img class="logo" src="images/smashkarts.png">
	<div class="spinner"></div>
	<div class="progress">
		<div class="full"></div>
	</div>
</div>
<div id="rotate-landscape">
	<img src="images/r.png" class="center">
</div>
   </body>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-app.js"></script>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-auth.js"></script>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-database.js"></script>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-analytics.js"></script>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-performance.js"></script>

<script src="https://cdn.jsdelivr.net/gh/tallteam/skunblocked1@main/scripts/main.js"></script>
<script src="https://cdn.jsdelivr.net/gh/tallteam/skunblocked1@main/scripts/auth.js"></script>
<script src="https://cdn.jsdelivr.net/gh/tallteam/skunblocked1@main/scripts/shop.js"></script>
<script src="https://cdn.jsdelivr.net/gh/tallteam/skunblocked1@main/scripts/cc.js"></script>
 
<script src="https://cdn.jsdelivr.net/gh/tallteam/skunblocked1@main/scripts/ads-common-logic.js"></script>
<script src="https://cdn.jsdelivr.net/gh/tallteam/skunblocked1@main/scripts/ads-offcanvas-logic.js"></script>
<script src="https://cdn.jsdelivr.net/gh/tallteam/skunblocked1@main/scripts/ads-positioning-logic.js"></script>
<script src="https://cdn.jsdelivr.net/gh/tallteam/skunblocked1@main/scripts/ads-injector.js"></script>

   <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('service-worker2.js');
      }

      var firebaseConfig = {
			apiKey: "AIzaSyAdY2qq9083amKDS0R8tn2tjIKQB8mocco",
			authDomain: "webgltest-17af1.firebaseapp.com",
			databaseURL: "https://webgltest-17af1.firebaseio.com",
			projectId: "webgltest-17af1",
			storageBucket: "webgltest-17af1.appspot.com",
			messagingSenderId: "480659433590",
			appId: "1:480659433590:web:a01ad1599e963843a0d757",
			measurementId: "G-1W23DRFHK9"
		};

	  // Initialize Firebase
	  	firebase.initializeApp(firebaseConfig);

      var firebaseSupported = false;
      if(firebase.analytics != null)
      {
        firebase.analytics.isSupported().then((isSupported) => 
        {
          if (isSupported) 
          {
            analytics = firebase.analytics();
            firebaseSupported = true;
          }
          else 
          {
            console.log("firebase.analytics() not supported ");
          }
        })
      }

      var perf = firebase.performance();

      firebaseSetScreen("loading_start");
      firebaseLogEvent("loading_page_start");

      var timerStart = Date.now();
      var sentGameInstanceStartEvent = false;
      
      const buildUrl ="https://smashkartsgc.b-cdn.net/Build2020New";
      const loaderUrl = buildUrl + "/c4c07f153778d8abf1842ac44b3ff052.loader.js";
      const config = {
        dataUrl: buildUrl + "/c603bc3234de75b89771a25f247d9fb3.data.br",
        frameworkUrl: buildUrl + "/b2121ee6a2b1fc035810ba89610deac2.framework.js.br",
        codeUrl: buildUrl + "/d5902046ae03cce30ca11a6d77cd3683.wasm.br",
// #if MEMORY_FILENAME
//         memoryUrl: buildUrl + "/{{{ MEMORY_FILENAME }}}",
// #endif
// #if SYMBOLS_FILENAME
//         symbolsUrl: buildUrl + "/{{{ SYMBOLS_FILENAME }}}",
// #endif
        streamingAssetsUrl: "StreamingAssets",
        companyName: "TallTeam",
        productName: "Smash Karts",
        productVersion: "1.0.9",
      };

      var container = document.querySelector("#mainContainer");
      var canvas = document.querySelector("#gameContainer");
      var loadingBar = document.querySelector("#loader");
      var progressBarFull = document.querySelector("#loader .progress .full");
      var rotateLandscape = document.querySelector("#rotate-landscape");

      if (isMobile()) 
      {
        container.className ="unity-mobile";
      }
      else
      {
        rotateLandscape.id ="rotateLandscapeOff";
        rotateLandscape.style.display ="none";
      }
      const progress = document.querySelector("#loader .progress");
          progress.style.display ="block";
          progressBarFull.style.width ="0%";
      const myTrace = perf.trace('unityLoader');
      myTrace.start();

      var script = document.createElement("script");
      script.src = loaderUrl;

      var progressCreateUnityInstance = 0;
      var progressPostCreateUnityInstance = 0;
      var updateProgressInterval = setInterval(updateProgress, 100);

      if(isMobile())
      {
        setInterval(updateScreenSize, 100);
      }
      var gameInstance;
      script.onload = () => {
          createUnityInstance(canvas, config, (progress) => {
          progressCreateUnityInstance = 100 * progress;
          setProgressWidth();
        }).then((unityInstance) => {
          if(isMobile()) document.body.style.background ="#000000";
          loadingBar.style.display ="none";
          window.unityGame = unityInstance;
          gameInstance = unityInstance;

          if(updateProgressInterval) clearInterval(updateProgressInterval);
          myTrace.stop();
          var lt = Date.now() - timerStart;
          firebaseLogEventWithParam("loading_page_complete", "time", lt);
          setV(lt);
        }).catch((message) => {
          alert("TT UnityLoader Error" + message);
        });
      };
      document.body.appendChild(script);

function updateProgress()
{
  if(progressCreateUnityInstance > 85)
  {
    progressPostCreateUnityInstance += 1;
    setProgressWidth();
  }
}

var lastInnerHeight;
function updateScreenSize()
{
  if(canvas)
  {
    if(!lastInnerHeight || lastInnerHeight != window.innerHeight)
    {
      lastInnerHeight = window.innerHeight;
      canvas.style.height = lastInnerHeight + "px";
    }
  }
}

function setProgressWidth()
{
  if(progressCreateUnityInstance == 100.0)
  {
    progressBarFull.style.width ="100%";
  }
  else
  {
    var percent;
    if(isMobile()) 
    {
      percent = progressCreateUnityInstance * 0.6 + (progressPostCreateUnityInstance*0.5*0.2 + progressCreateUnityInstance*0.5*0.2*0.05);
      percent =  Math.min(percent, 90);
    }
    else
    {
      percent = progressCreateUnityInstance * 0.9 + progressPostCreateUnityInstance * 0.1;
      percent = Math.min(percent, 95);
    }
    progressBarFull.style.width = percent + "%";
  }
}
   </script>
</html>

]]></Content>
</Module>
