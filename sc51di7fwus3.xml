<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="Smash Karts" />
<Content type="html"><![CDATA[

<!DOCTYPE html>
<html lang="en-us">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">


      <!-- <script type="text/javascript" src="xmlhttprequest-length-computable.js"></script> -->
      <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/zhit73/xml@943946a87f66424f2f80ac97c4b4a89995eba7c1/xmlhttprequest-length-computable.min.js"></script>
      <script type="text/javascript">
        window.xmlHTTPRequestLengthComputable = {
          CONTENT_ENCODING_MULTIPLE: 3.0
        }
      </script>

      <title>Smash Karts</title>
      <style>
         html {
         box-sizing: border-box;
         }
         *, *:before, *:after {
         box-sizing: inherit;
         }
         body {
         margin: 0;
         background: #1b70f0;
         background-image: url("images/overlay.png"), url("images/menuBGTile.png");
         background-size: cover, 13vw;
         background-repeat: no-repeat, repeat; 
         }
         #gameContainer {
          position: relative;
          width: 100vw;
          height: 100vh;
         }
         #adLongContainer {
          position: absolute;
          /* border: 1px solid red; */
          z-index: 100;
          bottom: 0px;
          width: 100vw;
          align-items: center;
          justify-content: center;
          }
         #adContainer {
          position: absolute;
          /* border: 1px solid red; */
          z-index: 100;
          top: 0px;
          right: 0px;
          width: auto;
          height: auto;
        }
          @media screen and (max-width: 600px) 
            {
              {
                /* border: 1px solid blue; */
                display: none;
              }
            }
            #adContainer2 {
          position: absolute;
          /* border: 1px solid red; */
          z-index: 100;
          top: 0px;
          right: 0px;
          width: auto;
          height: auto;
        }
          @media screen and (max-width: 600px) 
            {
              {
                /* border: 1px solid blue; */
                display: none;
              }
            }
         canvas {
         width: 100%;
         height: 100%;
         display: block;
         }
         /* try to handle mobile dialog */
         canvas + * {
         z-index: 2;
         }
         .logo {
         display: block;
         max-width: 90%;
         max-height: 40vh;
         }
         .progress {
         margin: 1.5em;
         border: 2px solid ;
         width: 25vw;
         display: none;
         }
         .progress .full {
         margin: 2px;
         background: white;
         height: 1em;
         transform-origin: top left;
         }
         #loader {
         position: absolute;
         left: 0;
         top: 0;
         width: 100vw;
         height: 100vh;
         display: flex;
         flex-direction: column;
         align-items: center;
         justify-content: center;
         background: #1b70f0;
         background-image: url("images/overlay.png"), url("images/menuBGTile.png");
         background-size: cover, 13vw;
         background-repeat: no-repeat, repeat; 
         }
         .spinner {
            position:absolute;
            left: 2vw;
            bottom: 2vh;
            border: 10px solid #f3f3f3; 
            border-top: 10px solid #3498db;
            border-radius: 50%;
            width: 10vh;
            height: 10vh;
            animation: spin 1s linear infinite;
          }

          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }


         /* for all screens */
        #rotate-landscape {display: none;}
       
        /* only when orientation is in portrait mode */
        @media all and (orientation:portrait) {
            #rotate-landscape {
              position: absolute;
              left: 0;
              top: 0;
              width: 100vw;
              height: 100vh;
              display: block;
              background: #1b70f0;
              background-image: url("images/overlay.png"), url("images/menuBGTile.png");
              background-size: cover, 13vw;
              background-repeat: no-repeat, repeat; 
            }
        }

        .center {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 90vw;
        }
      </style>


      <script>
        var url = (window.location != window.parent.location) ? document.referrer : document.location.href;
        let adBreak;
        if(url.startsWith("/") || url.startsWith("") ||
          url.startsWith("") || url.startsWith("")
          || url.includes("smashkarts-dev.firebaseapp.com"))
        {
          window.adsbygoogle = window.adsbygoogle || [];
          adBreak =  adConfig = function(o) {adsbygoogle.push(o);};
          adConfig({preloadAdBreaks: "on", sound: "on"});
        }
      </script>
      <!-- GOOGLE AD END -->

      <!-- AIP AD START -->
      <meta name="viewport" content="minimal-ui, user-scalable=no, initial-scale=1, maximum-scale=1, width=device-width" />
      <title>AdinPlay Ads</title>
      <script>
      window.aiptag = window.aiptag || {cmd: []};
      aiptag.cmd.display = aiptag.cmd.display || [];

      // Show GDPR consent tool
      aiptag.gdprShowConsentTool = true;
      aiptag.gdprConsentToolPosition ="bottom";
      </script>
      <script async src="/o__api.adinplay.com/libs/aiptag/pub/SHK/smashkarts.io/tag.min.js"></script>
      <!-- AIP AD END -->
      <!-- AD INIT END -->
   </head>
   <body>
    <div id="mainContainer">
      <canvas id="gameContainer"></canvas>
      <div id="loader">
         <img class="logo" src="https://lh6.googleusercontent.com/kXCFATbe9edo1UIK7KWzmJDWsHlr8V_UnEuvFQv_0kQMp4cj36qg5T_lk546lvuY0cV5HSlSlxTxCXvQ92Oj0A3ya7akvmqnUmeIKp7TId-6-98mUddrlArxZk7q7y1AcN8ug4zB">
         <div class="spinner"></div>
         <div class="progress">
            <div class="full"></div>
         </div>
                  
      </div>
      <div id="adContainer" style="display: none;">
      </div>
      <div id="adContainer2" style="display: none;">
      </div>
      <div id="adLongContainer" style="display: none;">
      </div>
      <div id="videoAdContainer">
        <div id="preroll"></div>
      </div>
    </div>
    <div id="rotate-landscape">
      <img src="/images/r.png" class="center">
    </div>
   </body>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-app.js"></script>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-auth.js"></script>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-database.js"></script>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-analytics.js"></script>
   <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-performance.js"></script>

   <script src="https://cdn.jsdelivr.net/gh/zhit73/xml@d5fed179d2756da889d93d19c04ce92392bf9ecb/main-v2.js"></script>
   <script src="https://cdn.jsdelivr.net/gh/zhit73/xml@d5fed179d2756da889d93d19c04ce92392bf9ecb/auth-v2.js"></script>
   <script src="https://cdn.jsdelivr.net/gh/zhit73/xml@d5fed179d2756da889d93d19c04ce92392bf9ecb/ads-v2.js"></script>
   <script src="https://cdn.jsdelivr.net/gh/zhit73/xml@d5fed179d2756da889d93d19c04ce92392bf9ecb/ads-adsbygoogle-v2.js"></script>
   <script src="https://cdn.jsdelivr.net/gh/zhit73/xml@d5fed179d2756da889d93d19c04ce92392bf9ecb/ad-blocker.js" type="text/javascript"></script>

   <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('service-worker2.js');
      }

      var firebaseConfig = {
			apiKey: "AIzaSyAdY2qq9083amKDS0R8tn2tjIKQB8mocco",
			authDomain: "webgltest-17af1.firebaseapp.com",
			databaseURL: "https://webgltest-17af1.firebaseio.com",
			projectId: "webgltest-17af1",
			storageBucket: "webgltest-17af1.appspot.com",
			messagingSenderId: "480659433590",
			appId: "1:480659433590:web:a01ad1599e963843a0d757",
			measurementId: "G-1W23DRFHK9"
		};

	  // Initialize Firebase
	  	firebase.initializeApp(firebaseConfig);

      var firebaseSupported = false;
      if(firebase.analytics != null)
      {
        firebase.analytics.isSupported().then((isSupported) => 
        {
          if (isSupported) 
          {
            analytics = firebase.analytics();
            firebaseSupported = true;
          }
          else 
          {
            console.log("firebase.analytics() not supported ");
          }
        })
      }

      var perf = firebase.performance();

      firebaseSetScreen("loading_start");
      firebaseLogEvent("loading_page_start");

      var timerStart = Date.now();
      var sentGameInstanceStartEvent = false;
      
      const buildUrl ="https://smashkartsgc.b-cdn.net/Build2020New";
      const loaderUrl = buildUrl + "/c4c07f153778d8abf1842ac44b3ff052.loader.js";
      const config = {
        dataUrl: buildUrl + "/c603bc3234de75b89771a25f247d9fb3.data.br",
        frameworkUrl: buildUrl + "/b2121ee6a2b1fc035810ba89610deac2.framework.js.br",
        codeUrl: buildUrl + "/d5902046ae03cce30ca11a6d77cd3683.wasm.br",
// #if MEMORY_FILENAME
//         memoryUrl: buildUrl + "/{{{ MEMORY_FILENAME }}}",
// #endif
// #if SYMBOLS_FILENAME
//         symbolsUrl: buildUrl + "/{{{ SYMBOLS_FILENAME }}}",
// #endif
        streamingAssetsUrl: "StreamingAssets",
        companyName: "TallTeam",
        productName: "Smash Karts",
        productVersion: "1.0.9",
      };

      var container = document.querySelector("#mainContainer");
      var canvas = document.querySelector("#gameContainer");
      var loadingBar = document.querySelector("#loader");
      var progressBarFull = document.querySelector("#loader .progress .full");
      var rotateLandscape = document.querySelector("#rotate-landscape");

      if (isMobile()) 
      {
        container.className ="unity-mobile";
      }
      else
      {
        rotateLandscape.id ="rotateLandscapeOff";
        rotateLandscape.style.display ="none";
      }
      const progress = document.querySelector("#loader .progress");
          progress.style.display ="block";
          progressBarFull.style.width ="0%";
      const myTrace = perf.trace('unityLoader');
      myTrace.start();

      var script = document.createElement("script");
      script.src = loaderUrl;

      var progressCreateUnityInstance = 0;
      var progressPostCreateUnityInstance = 0;
      var updateProgressInterval = setInterval(updateProgress, 100);

      if(isMobile())
      {
        setInterval(updateScreenSize, 100);
      }
      var gameInstance;
      script.onload = () => {
          createUnityInstance(canvas, config, (progress) => {
          progressCreateUnityInstance = 100 * progress;
          setProgressWidth();
        }).then((unityInstance) => {
          if(isMobile()) document.body.style.background ="#000000";
          loadingBar.style.display ="none";
          window.unityGame = unityInstance;
          gameInstance = unityInstance;

          if(updateProgressInterval) clearInterval(updateProgressInterval);
          myTrace.stop();
          var lt = Date.now() - timerStart;
          firebaseLogEventWithParam("loading_page_complete", "time", lt);
          setV(lt);
        }).catch((message) => {
          alert("TT UnityLoader Error" + message);
        });
      };
      document.body.appendChild(script);

function updateProgress()
{
  if(progressCreateUnityInstance > 85)
  {
    progressPostCreateUnityInstance += 1;
    setProgressWidth();
  }
}

var lastInnerHeight;
function updateScreenSize()
{
  if(canvas)
  {
    if(!lastInnerHeight || lastInnerHeight != window.innerHeight)
    {
      lastInnerHeight = window.innerHeight;
      canvas.style.height = lastInnerHeight + "px";
    }
  }
}

function setProgressWidth()
{
  if(progressCreateUnityInstance == 100.0)
  {
    progressBarFull.style.width ="100%";
  }
  else
  {
    var percent;
    if(isMobile()) 
    {
      percent = progressCreateUnityInstance * 0.6 + (progressPostCreateUnityInstance*0.5*0.2 + progressCreateUnityInstance*0.5*0.2*0.05);
      percent =  Math.min(percent, 90);
    }
    else
    {
      percent = progressCreateUnityInstance * 0.9 + progressPostCreateUnityInstance * 0.1;
      percent = Math.min(percent, 95);
    }
    progressBarFull.style.width = percent + "%";
  }
}
   </script>
</html>

]]></Content>
</Module>
